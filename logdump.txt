/GrokMode/GrokModeTests/GrokModeTests/testMockAudioTransmission() - 1 failed test run (avg. duration: 4.0 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testMockAudioTransmission() on iPad (A16) Test Scheme Action with failure message: GrokModeTests.swift:121: Caught error: .notConnected
/GrokMode/GrokModeTests/GrokModeTests/testOperationsWithoutConnection() - 1 passed test run
/GrokMode/GrokModeTests/GrokModeTests/testGetEphemeralToken() - 1 passed test run (avg. duration: 1 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testSessionConfiguration() - 1 failed test run (avg. duration: 11 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testSessionConfiguration() on iPad (A16) Test Scheme Action with failure message: GrokModeTests.swift:87: Expectation failed: sessionConfigured: Session should be configured after connection
/GrokMode/GrokModeTests/GrokModeTests/testSessionConfiguration() on iPad (A16) Test Scheme Action with failure message: GrokModeTests.swift:91: Expectation failed: conversationCreated: Should receive conversation.created message
/GrokMode/GrokModeTests/GrokModeTests/testInvalidAPIKey() - 1 passed test run (avg. duration: 1 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testServiceCleanup() - 1 passed test run (avg. duration: 1 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testWebSocketConnection() - 1 failed test run (avg. duration: 3.0 seconds)
/GrokMode/GrokModeTests/GrokModeTests/testWebSocketConnection() on iPad (A16) Test Scheme Action with failure message: GrokModeTests.swift:55: Expectation failed: connectionEstablished: // Verify connection was established
WebSocket connection should be established


â—‡ Test run started.
â†³ Testing Library Version: 1085
â†³ Target Platform: arm64-apple-ios13.0-simulator
â—‡ Suite GrokModeTests started.
â—‡ Test "Test mock audio data transmission" started.
â—‡ Test "Test WebSocket operations when not connected" started.
â—‡ Test "Test ephemeral token acquisition from XAI API" started.
â—‡ Test "Test session configuration after connection" started.
â—‡ Test "Test connection with invalid API key" started.
â—‡ Test "Test service cleanup on deinit" started.
â—‡ Test "Test WebSocket connection establishment" started.
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***VsD6VPd8lQ***
ğŸ”‘   Content-Type: application/json
ğŸ”Œ WebSocket disconnected
ğŸ”‘ Request Body (JSON):
âœ” Test "Test WebSocket operations when not connected" passed after 0.041 seconds.
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***id-api-key***
ğŸ”‘   Content-Type: application/json
ğŸ”‘ Request Body (JSON):
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”Œ Connecting to XAI Voice API...
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***VsD6VPd8lQ***
ğŸ”‘   Content-Type: application/json
ğŸ”‘ Request Body (JSON):
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”Œ Connecting to XAI Voice API...
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***VsD6VPd8lQ***
ğŸ”‘   Content-Type: application/json
ğŸ”‘ Request Body (JSON):
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”Œ Connecting to XAI Voice API...
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***VsD6VPd8lQ***
ğŸ”‘   Content-Type: application/json
ğŸ”‘ Request Body (JSON):
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”Œ Connecting to XAI Voice API...
ğŸ”‘ ===== STARTING EPHEMERAL TOKEN REQUEST =====
ğŸ”‘ Requesting ephemeral token from XAI API...
ğŸ”‘ URL: https://api.x.ai/v1/realtime/client_secrets
ğŸ”‘ HTTP Method: POST
ğŸ”‘ Request Headers:
ğŸ”‘   Authorization: Bearer ***VsD6VPd8lQ***
ğŸ”‘   Content-Type: application/json
ğŸ”‘ Request Body (JSON):
ğŸ”‘   ["expires_after": ["seconds": 300]]
ğŸ”‘ Request Body (Raw):
ğŸ”‘   {"expires_after":{"seconds":300}}
ğŸ”‘ ===== SENDING REQUEST =====
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 200
ğŸ”‘ Response Status: no error
ğŸ”‘ Response Headers:
ğŸ”‘   Server: cloudflare
ğŸ”‘   cf-ray: 9aa0747ddb18fb2c-SJC
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   Content-Encoding: gzip
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘   Content-Type: application/json
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘ Response Body (Raw Data Length): 143 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"value":"xai-realtime-client-secret-gPvJHw4KnswERujSl0z2jx4srFMKpw7ycCZMy8W4FAb5I9Gj2WAamGg3miynSoLmDvXlhmCxbaPrAN4D","expires_at":1765073395}
ğŸ”‘ ===== PARSING JSON RESPONSE =====
âœ… Successfully parsed JSON response
âœ… Token Value: xai-realti...CxbaPrAN4D
âœ… Token Expires At: 2025-12-07 02:09:55 +0000
âœ… Token Expires In: 299.30326795578003 seconds
âœ… ===== TOKEN ACQUISITION SUCCESSFUL =====
âœ… WebSocket connected to XAI API
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 200
ğŸ”‘ Response Status: no error
ğŸ”‘ Response Headers:
ğŸ”Œ WebSocket disconnected
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   cf-ray: 9aa0747ddea6ccb8-SJC
ğŸ”‘   Content-Type: application/json
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   report-to: {"endpoints":[{"url":"https:\/\/csp-reporting.cloudflare.com\/cdn-cgi\/script_monitor\/report?m=TajJ4oMdhOBNVoa3tJIhcwHBfFqvnBY2S2Uosfv2mhQ-1765073095-1.0.1.1-zQnblWN5vkUqaCF14UEYg57dcsUjiuMc.IteM5JxjdMIO8SXfht4QOBgAp47f7DKVLjKmWl_.u04VFFnvhD2BgTdfatg8OFfClEyk4Ysyo5SCfTV2uQJ6.oqtaiKHrIKlEzuZpNY8FQBGNKGaZJnO4_a9bj.nqMwu4032YN.KLc"}],"group":"cf-csp-endpoint","max_age":86400}
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘   Server: cloudflare
ğŸ”‘   content-security-policy-report-only: script-src 'none'; report-uri https://csp-reporting.cloudflare.com/cdn-cgi/script_monitor/report?m=TajJ4oMdhOBNVoa3tJIhcwHBfFqvnBY2S2Uosfv2mhQ-1765073095-1.0.1.1-zQnblWN5vkUqaCF14UEYg57dcsUjiuMc.IteM5JxjdMIO8SXfht4QOBgAp47f7DKVLjKmWl_.u04VFFnvhD2BgTdfatg8OFfClEyk4Ysyo5SCfTV2uQJ6.oqtaiKHrIKlEzuZpNY8FQBGNKGaZJnO4_a9bj.nqMwu4032YN.KLc; report-to cf-csp-endpoint
ğŸ”‘   Content-Encoding: gzip
ğŸ”‘ Response Body (Raw Data Length): 143 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"value":"xai-realtime-client-secret-qny2PSXbAyvipzLxreRC6g6YJtGUQDW4MHq4iL5fQIRYRelIIv9LbngX8YhBGyCpQbPjlyfYDFj2ln8q","expires_at":1765073395}
ğŸ”‘ ===== PARSING JSON RESPONSE =====
âœ… Successfully parsed JSON response
âœ… Token Value: xai-realti...fYDFj2ln8q
âœ… Token Expires At: 2025-12-07 02:09:55 +0000
âœ… Token Expires In: 299.30256605148315 seconds
âœ… ===== TOKEN ACQUISITION SUCCESSFUL =====
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 400
âœ” Test "Test service cleanup on deinit" passed after 0.875 seconds.
ğŸ”‘ Response Status: bad request
ğŸ”‘ Response Headers:
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   cf-ray: 9aa0747dfb92133c-SJC
ğŸ”‘   Content-Type: application/json
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   Content-Length: 147
ğŸ”‘   Server: cloudflare
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘ Response Body (Raw Data Length): 147 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"code":"Client specified an invalid argument","error":"Incorrect API key provided: in***ey. You can obtain an API key from https://console.x.ai."}
âŒ ERROR: HTTP 400 - {"code":"Client specified an invalid argument","error":"Incorrect API key provided: in***ey. You can obtain an API key from https://console.x.ai."}
âŒ ERROR: Network request failed
ğŸ”Œ WebSocket disconnected
âœ” Test "Test ephemeral token acquisition from XAI API" passed after 0.875 seconds.
âŒ Network Error: apiError(statusCode: 400, message: "{\"code\":\"Client specified an invalid argument\",\"error\":\"Incorrect API key provided: in***ey. You can obtain an API key from https://console.x.ai.\"}")
âŒ Error Type: XAIVoiceError
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 200
ğŸ”‘ Response Status: no error
ğŸ”‘ Response Headers:
ğŸ”Œ WebSocket disconnected
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   Content-Encoding: gzip
ğŸ”‘   Content-Type: application/json
ğŸ”‘   cf-ray: 9aa0747dcda62ed1-SJC
ğŸ”‘   Server: cloudflare
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘ Response Body (Raw Data Length): 143 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"value":"xai-realtime-client-secret-5TbyJbtAsLryO937it9ge9GCyU63cCnX11MPV1klwaTdYy3aKztTSDL8te4E91RyyHqWqfIHM1l91OE8","expires_at":1765073395}
ğŸ”‘ ===== PARSING JSON RESPONSE =====
âœ… Successfully parsed JSON response
âœ… Token Value: xai-realti...IHM1l91OE8
âœ” Test "Test connection with invalid API key" passed after 0.880 seconds.
âœ… Token Expires At: 2025-12-07 02:09:55 +0000
âœ… Token Expires In: 299.255117893219 seconds
âœ… ===== TOKEN ACQUISITION SUCCESSFUL =====
âœ… WebSocket connected to XAI API
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 200
ğŸ”‘ Response Status: no error
ğŸ”‘ Response Headers:
ğŸ”‘   Server: cloudflare
ğŸ”‘   cf-ray: 9aa0747dec69cf0a-SJC
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   Content-Encoding: gzip
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘   Content-Type: application/json
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘ Response Body (Raw Data Length): 143 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"value":"xai-realtime-client-secret-ULhOKe185rJvPcqpYtMxi55fTzdJ2WaiDoeLtMl9txKNQHiHniGJGMLn0LjI4EoUTVBjxwE1gonm2t0W","expires_at":1765073395}
ğŸ”‘ ===== PARSING JSON RESPONSE =====
âœ… Successfully parsed JSON response
âœ… Token Value: xai-realti...E1gonm2t0W
âœ… Token Expires At: 2025-12-07 02:09:55 +0000
âœ… Token Expires In: 299.2544279098511 seconds
âœ… ===== TOKEN ACQUISITION SUCCESSFUL =====
âœ… WebSocket connected to XAI API
ğŸ”‘ ===== RECEIVED RESPONSE =====
ğŸ”‘ Response Status Code: 200
ğŸ”‘ Response Status: no error
ğŸ”‘ Response Headers:
ğŸ”‘   Access-Control-Allow-Origin: *
ğŸ”‘   Content-Encoding: gzip
ğŸ”‘   Content-Type: application/json
ğŸ”‘   cf-cache-status: DYNAMIC
ğŸ”‘   Date: Sun, 07 Dec 2025 02:04:55 GMT
ğŸ”‘   Server: cloudflare
ğŸ”‘   cf-ray: 9aa0747e1f827543-SJC
ğŸ”‘   Strict-Transport-Security: max-age=31536000
ğŸ”‘   Vary: origin, access-control-request-method, access-control-request-headers
ğŸ”‘   access-control-expose-headers: *
ğŸ”‘ Response Body (Raw Data Length): 143 bytes
ğŸ”‘ Response Body (String):
ğŸ”‘   {"value":"xai-realtime-client-secret-5T1A50sFU7KG55lbmqzsUdJrb4QjVgayN8pPKuq1zEAa5z5JqrCdGV0x9FdXU5H7a3zj5QfXws9rGGa3","expires_at":1765073395}
ğŸ”‘ ===== PARSING JSON RESPONSE =====
âœ… Successfully parsed JSON response
âœ… Token Value: xai-realti...fXws9rGGa3
âœ… Token Expires At: 2025-12-07 02:09:55 +0000
âœ… Token Expires In: 299.2531261444092 seconds
âœ… ===== TOKEN ACQUISITION SUCCESSFUL =====
âœ… WebSocket connected to XAI API
Task <E00010F7-7C8B-4CED-B8B0-D46653EFB05E>.<2> finished with error [-1011] Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, _NSURLErrorRelatedURLSessionTaskErrorKey=(
    "LocalWebSocketTask <E00010F7-7C8B-4CED-B8B0-D46653EFB05E>.<2>"
), _NSURLErrorFailingURLSessionTaskErrorKey=LocalWebSocketTask <E00010F7-7C8B-4CED-B8B0-D46653EFB05E>.<2>, NSLocalizedDescription=There was a bad response from the server.}
Task <F00873EC-EF57-42A1-AC99-D1126CA16992>.<2> finished with error [-1011] Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, _NSURLErrorRelatedURLSessionTaskErrorKey=(
    "LocalWebSocketTask <F00873EC-EF57-42A1-AC99-D1126CA16992>.<2>"
), _NSURLErrorFailingURLSessionTaskErrorKey=LocalWebSocketTask <F00873EC-EF57-42A1-AC99-D1126CA16992>.<2>, NSLocalizedDescription=There was a bad response from the server.}
âŒ WebSocket receive error: Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, NSLocalizedDescription=There was a bad response from the server.}
âŒ WebSocket receive error: Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, NSLocalizedDescription=There was a bad response from the server.}
âŒ WebSocket receive error: Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, NSLocalizedDescription=There was a bad response from the server.}
Task <5462CB24-EFD6-483A-A217-9E7F3BE86D1F>.<2> finished with error [-1011] Error Domain=NSURLErrorDomain Code=-1011 "There was a bad response from the server." UserInfo={NSErrorFailingURLStringKey=wss://api.x.ai/v1/realtime, NSErrorFailingURLKey=wss://api.x.ai/v1/realtime, _NSURLErrorWebSocketHandshakeFailureReasonKey=0, _NSURLErrorRelatedURLSessionTaskErrorKey=(
    "LocalWebSocketTask <5462CB24-EFD6-483A-A217-9E7F3BE86D1F>.<2>"
), _NSURLErrorFailingURLSessionTaskErrorKey=LocalWebSocketTask <5462CB24-EFD6-483A-A217-9E7F3BE86D1F>.<2>, NSLocalizedDescription=There was a bad response from the server.}
âœ˜ Test "Test WebSocket connection establishment" recorded an issue at GrokModeTests.swift:55:9: Expectation failed: connectionEstablished
â†³ // Verify connection was established
â†³ WebSocket connection should be established
ğŸ”Œ WebSocket disconnected
ğŸ”Œ WebSocket disconnected
âœ˜ Test "Test WebSocket connection establishment" failed after 2.932 seconds with 1 issue.
ğŸ”Œ WebSocket disconnected
âœ˜ Test "Test mock audio data transmission" recorded an issue at GrokModeTests.swift:97:6: Caught error: notConnected
âœ˜ Test "Test mock audio data transmission" failed after 3.950 seconds with 1 issue.
âœ˜ Test "Test session configuration after connection" recorded an issue at GrokModeTests.swift:87:9: Expectation failed: sessionConfigured
â†³ Session should be configured after connection
âœ˜ Test "Test session configuration after connection" recorded an issue at GrokModeTests.swift:91:9: Expectation failed: conversationCreated
â†³ Should receive conversation.created message
ğŸ”Œ WebSocket disconnected
ğŸ”Œ WebSocket disconnected
âœ˜ Test "Test session configuration after connection" failed after 11.158 seconds with 2 issues.
âœ˜ Suite GrokModeTests failed after 11.162 seconds with 4 issues.
âœ˜ Test run with 7 tests in 1 suite failed after 11.162 seconds with 4 issues.